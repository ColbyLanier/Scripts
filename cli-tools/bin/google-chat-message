#!/usr/bin/env bash
# Google Chat Message CLI - wrapper for test command
#
# DEPRECATED: This command is deprecated. Use "test" instead.
#   google-chat-message "hello" → test "hello"
#   google-chat-message "hello" --one-shot → test "hello" --one-shot
#
# This wrapper provides backward compatibility but will be removed in future versions.

set -euo pipefail

TEST_CMD="$HOME/Scripts/cli-tools/bin/test"

# Check if help is requested
if [[ "${1:-}" == "--help" ]] || [[ "${1:-}" == "-h" ]]; then
    cat << 'EOF'
Google Chat Message CLI (DEPRECATED)

⚠️  DEPRECATED: Use "test" command instead

This command is deprecated and will be removed in a future version.
Please use the new "test" command:

  google-chat-message "hello"           → test "hello"
  google-chat-message "hello" --one-shot → test "hello" --one-shot

The test command provides additional features:
  - Health checks: test
  - HTTP endpoints: test /api/status
  - Dry run mode: test "hello" --dry-run
  - Auto-detection of server state

See "test --help" for more information.
EOF
    exit 0
fi

# Show deprecation notice (to stderr so it doesn't interfere with output)
echo "⚠️  Warning: google-chat-message is deprecated, use 'test' command instead" >&2
echo "   Example: test \"$1\"" >&2
echo "" >&2

# Verify test command exists
if [[ ! -f "$TEST_CMD" ]]; then
    echo "Error: test command not found at $TEST_CMD" >&2
    echo "Falling back to legacy implementation..." >&2
    exec "$HOME/Scripts/cli-tools/bin/cli-wrapper" google-chat-message "$@"
fi

# Forward all arguments to test command
exec "$TEST_CMD" "$@"
